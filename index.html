<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NeonTrade - Secure Protocol</title>
    
    <!-- CSS Assets -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Rajdhani:wght@600;700&display=swap" rel="stylesheet">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>

    <style>
        :root {
            --neon-green: #00ff55;
            --dark-bg: #000000;
            --glass: rgba(0, 255, 85, 0.08);
            --border: rgba(0, 255, 85, 0.3);
        }

        body {
            background-color: var(--dark-bg);
            background-image: radial-gradient(circle at top right, #0a200a, #000);
            color: #fff;
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding-bottom: 80px;
            overflow-x: hidden;
        }

        .rajdhani { font-family: 'Rajdhani', sans-serif; text-transform: uppercase; }
        .neon-text { color: var(--neon-green); text-shadow: 0 0 10px rgba(0, 255, 85, 0.5); }
        .glass-panel { background: var(--glass); backdrop-filter: blur(10px); border: 1px solid var(--border); border-radius: 15px; padding: 15px; }

        /* Login Overlay */
        #auth-screen {
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .auth-card { width: 100%; max-width: 400px; padding: 30px; border: 1px solid var(--neon-green); box-shadow: 0 0 20px rgba(0, 255, 85, 0.2); }
        .form-control { background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: #fff; }
        .form-control:focus { background: rgba(255,255,255,0.1); border-color: var(--neon-green); color: #fff; box-shadow: none; }

        /* App Layout */
        #app-content { display: none; }
        .view-section { display: none; padding: 10px; }
        .view-section.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .mobile-nav { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.9); border-top: 1px solid var(--border); display: flex; justify-content: space-around; padding: 12px 0; z-index: 1000; }
        .nav-item { color: #555; text-decoration: none; text-align: center; font-size: 0.7rem; }
        .nav-item.active { color: var(--neon-green); }
        .nav-item i { font-size: 1.5rem; display: block; }

        #loading-screen { position: fixed; inset: 0; background: #000; z-index: 11000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="spinner-border text-success mb-3"></div>
        <h4 class="rajdhani neon-text">NEON TRADE</h4>
    </div>

    <!-- AUTHENTICATION SCREEN -->
    <div id="auth-screen">
        <div class="auth-card glass-panel text-center">
            <h2 class="rajdhani neon-text mb-4" id="auth-title">ACCESS PORTAL</h2>
            
            <input type="email" id="auth-email" class="form-control mb-3" placeholder="Neural Email">
            <input type="password" id="auth-pass" class="form-control mb-4" placeholder="Security Key">
            
            <button class="btn btn-success w-100 fw-bold mb-3 py-2" onclick="handleAuth()">INITIALIZE LINK</button>
            <p class="small text-secondary" id="auth-toggle-text">
                New Protocol? <a href="javascript:void(0)" class="neon-text" onclick="toggleAuthMode()">Register UID</a>
            </p>
        </div>
    </div>

    <!-- MAIN APP CONTENT -->
    <div id="app-content">
        <header class="p-3 d-flex justify-content-between align-items-center">
            <div>
                <h5 class="rajdhani m-0">Protocol <span class="neon-text">Green</span></h5>
                <small class="text-secondary" id="user-display" style="font-size: 0.6rem;">UID: ...</small>
            </div>
            <button class="btn btn-sm btn-outline-danger" onclick="logout()"><i class="bi bi-power"></i></button>
        </header>

        <main class="container-fluid">
            <!-- TRADE VIEW -->
            <section id="view-trade" class="view-section active">
                <div class="glass-panel text-center mb-3">
                    <small class="text-secondary text-uppercase">Live BTC/USDT</small>
                    <h2 class="rajdhani neon-text mb-0" id="live-price">65,420.00</h2>
                </div>
                <div class="glass-panel p-1 mb-3">
                    <canvas id="mainChart" style="height: 250px; width: 100%;"></canvas>
                </div>
                <div class="row g-3">
                    <div class="col-6"><button class="btn btn-success w-100 py-3 fw-bold" onclick="executeOrder('BUY')">CALL</button></div>
                    <div class="col-6"><button class="btn btn-danger w-100 py-3 fw-bold" onclick="executeOrder('SELL')">PUT</button></div>
                </div>
                <div id="active-orders" class="mt-4"></div>
            </section>

            <!-- WALLET VIEW -->
            <section id="view-wallet" class="view-section">
                <div class="glass-panel border-start border-4 border-success mb-4">
                    <p class="text-secondary small mb-1">CREDIT BALANCE</p>
                    <h1 class="rajdhani display-5" id="wallet-balance">₹0.00</h1>
                </div>
                <div class="glass-panel border-secondary">
                    <h6 class="rajdhani text-success mb-3">Deposit Credits</h6>
                    <input type="number" id="dep-amt" class="form-control bg-dark text-white mb-2" placeholder="Amount">
                    <a href="https://www.instamojo.com/@rajeshjani121/" target="_blank" class="btn btn-outline-success btn-sm w-100 mb-3">PAY VIA INSTAMOJO</a>
                    <input type="text" id="dep-utr" class="form-control bg-dark text-white mb-2" placeholder="Transaction ID / UTR">
                    <button class="btn btn-success w-100" onclick="submitDeposit()">SUBMIT FOR APPROVAL</button>
                </div>
            </section>

            <!-- STATS VIEW -->
            <section id="view-stats" class="view-section">
                <h5 class="rajdhani neon-text mb-3">Performance Log</h5>
                <div class="glass-panel mb-3">
                    <div id="ai-log" class="small text-info" style="font-family: monospace; height: 200px; overflow-y: auto;">
                        > SYSTEM READY...
                    </div>
                </div>
            </section>
        </main>

        <nav class="mobile-nav">
            <a href="javascript:void(0)" class="nav-item active" onclick="switchView('trade', this)"><i class="bi bi-graph-up"></i>Trade</a>
            <a href="javascript:void(0)" class="nav-item" onclick="switchView('wallet', this)"><i class="bi bi-wallet2"></i>Wallet</a>
            <a href="javascript:void(0)" class="nav-item" onclick="switchView('stats', this)"><i class="bi bi-cpu"></i>AI</a>
        </nav>
    </div>

    <script>
        // --- FIREBASE CONFIG ---
        const firebaseConfig = {
  apiKey: "AIzaSyCHZ4_PhE2gbJBDzipArubqJpHW88Alw5o",
  authDomain: "tournament-62f77.firebaseapp.com",
  databaseURL: "https://tournament-62f77-default-rtdb.firebaseio.com",
  projectId: "tournament-62f77",
  storageBucket: "tournament-62f77.firebasestorage.app",
  messagingSenderId: "59905181993",
  appId: "1:59905181993:web:8ad4f721ac50c09c478f38",
  measurementId: "G-QHHJ1BJWMP"
};


        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();

        let state = { balance: 0, price: 65420, candles: [], isLoginMode: true };
        let currentUser = null;

        // --- AUTH LOGIC ---
        auth.onAuthStateChanged(user => {
            document.getElementById('loading-screen').style.display = 'none';
            if (user) {
                currentUser = user;
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('app-content').style.display = 'block';
                document.getElementById('user-display').innerText = 'UID: ' + user.uid.substr(0,8);
                loadUserData();
            } else {
                document.getElementById('auth-screen').style.display = 'flex';
                document.getElementById('app-content').style.display = 'none';
            }
        });

        function handleAuth() {
            const email = document.getElementById('auth-email').value;
            const pass = document.getElementById('auth-pass').value;
            if(!email || !pass) return alert("Fill all fields");

            if(state.isLoginMode) {
                auth.signInWithEmailAndPassword(email, pass).catch(e => alert(e.message));
            } else {
                auth.createUserWithEmailAndPassword(email, pass).then(res => {
                    db.ref('users/' + res.user.uid).set({ balance: 0, stats: {total:0, wins:0} });
                }).catch(e => alert(e.message));
            }
        }

        function toggleAuthMode() {
            state.isLoginMode = !state.isLoginMode;
            document.getElementById('auth-title').innerText = state.isLoginMode ? "ACCESS PORTAL" : "CREATE PROTOCOL";
            document.getElementById('auth-toggle-text').innerHTML = state.isLoginMode ? 
                'New Protocol? <a href="#" class="neon-text" onclick="toggleAuthMode()">Register UID</a>' : 
                'Have ID? <a href="#" class="neon-text" onclick="toggleAuthMode()">Login</a>';
        }

        function logout() { auth.signOut(); }

        // --- DATA LOGIC ---
        function loadUserData() {
            db.ref('users/' + currentUser.uid).on('value', snap => {
                const data = snap.val();
                if(data) {
                    state.balance = data.balance || 0;
                    updateUI();
                }
            });
        }

        function updateUI() {
            document.getElementById('wallet-balance').innerText = `₹${state.balance.toFixed(2)}`;
        }

        function switchView(viewId, el) {
            document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(`view-${viewId}`).classList.add('active');
            el.classList.add('active');
        }

        // --- TRADE & CHART (Simplified) ---
        function executeOrder(dir) {
            if(state.balance < 100) return notify("Low Balance", "danger");
            state.balance -= 100;
            db.ref('users/' + currentUser.uid).update({ balance: state.balance });
            notify(`Order Placed: ${dir}`, "info");
            setTimeout(() => {
                const win = Math.random() > 0.4;
                if(win) {
                    state.balance += 185;
                    db.ref('users/' + currentUser.uid).update({ balance: state.balance });
                    notify("WIN: +₹185", "success");
                } else {
                    notify("LOSS: -₹100", "danger");
                }
            }, 5000);
        }

        function submitDeposit() {
            const amt = document.getElementById('dep-amt').value;
            const utr = document.getElementById('dep-utr').value;
            db.ref('deposits').push({ uid: currentUser.uid, email: currentUser.email, amt, utr, status: 'pending' });
            alert("Deposit submitted for approval!");
        }

        function notify(msg, type) {
            const log = document.getElementById('ai-log');
            log.innerHTML = `<div class="text-${type}">> ${msg}</div>` + log.innerHTML;
        }

        // --- MINI CHART ENGINE ---
        const canvas = document.getElementById('mainChart');
        const ctx = canvas.getContext('2d');
        function initChart() {
            setInterval(() => {
                state.price += (Math.random() - 0.5) * 10;
                document.getElementById('live-price').innerText = state.price.toFixed(2);
                drawChart();
            }, 1000);
        }

        function drawChart() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            ctx.strokeStyle = "#00ff55";
            ctx.beginPath();
            ctx.moveTo(0, canvas.height/2);
            for(let i=0; i<canvas.width; i+=10) {
                ctx.lineTo(i, (canvas.height/2) + (Math.random()-0.5)*50);
            }
            ctx.stroke();
        }

        window.onload = () => { initChart(); };
    </script>
</body>
        </html>
